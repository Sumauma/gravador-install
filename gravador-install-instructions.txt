Centos 8 Stream install:

DVD ISO:
keyboard: Portuguese Brazil
language: ENglish USA
Time and Date: Americas/Sao Paulo
Software Selection: Server with development tools, headless management, RPM development, System Tools, Power Tools
Kdump disabled
or with docker:
dnf update
dnf groupinfo "Development Tools"
dnf group install "Development Tools"
dnf groupinfo "Power Tools"
dnf group install "Power Tools"
dnf install centos-release-stream -y --allowerasing
dnf install epel-release epel-next-release

1) descompactar o arquivo arquivos-instalacao-orkaudio.tar.gz no /root
cd /root
2) instalar o Java JDK:
rpm -ivh jdk-8u202-linux-x64.rpm
3) copiar os arquivos de configuracao do ORKAUDIO:
cd /root/etc
cp * /etc/orkaudio
4) copiar os arquivos de inicializacao do ORKAUDIO e do TOMCAT:
cd /root/init.d
cp * /etc/init.d
5) editar o arquivo abaixo e verificar se o path do JDK do JAVA esta correto no dir /usr/lib/jvm:
ls /usr/lib/jvm/
cp bash-profile-do-usuario-root-gravador.txt /root/.bash_profile

6) configurar a interface de rede que vai sniffar os pacotes SIP/RTP(mirror de pcap):
cd /etc/orkaudio
vi config.xml
Procure por:
<Devices>eth1</Devices>
Mude para o nome da sua placa de rede no linux:
<Devices>enp0s3</Devices>

7) vamos configurar pra auto iniciar o orkaudio e o tomcat ao bootar:
cd /etc/init.d
chkconfig --add orkaudio 
chkconfig --add tomcat
 
 8) instalar e configurar o MYSQL:
 dnf install mysql-server
 systemctl enable mysqld.service
 systemctl start mysqld.service
 mysql_secure_installation
 
mysql -p
create database cdrs;
quit
cd /root/
mysql -p cdrs < mysql-cdrs.sql
quit

9) criar o diretorio onde os arquivos de audio das gravacoes serao armazenados localmente para posterior envio pra um NAS ou nuvem:
mkdir /var/log/orkaudio

10) configurar no TOMCAT o endereco ip e porta que o TOMCAT ira ficar ouvindo por INVITEs SIPREC:

cd /root/sumauma-siprec-server/webapps/orktrack/WEB-INF

editar os arquivos: web.xml e sip.xml para mudar senha e ip do servidor.

11) instalacao do DOCKER:
instalar o docker e rodar a nossa app docker de gravacao:
sudo yum install -y yum-utils
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

sudo yum install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo systemctl enable docker
sudo systemctl start docker
cd /root
12) criar a aplicacao Docker do Orkaudio para se inicializar sempre que a VM reiniciar:
sudo docker run -it --net=host --restart=always --privileged=true -v /var/log/orkaudio:/var/log/orkaudio  -v /etc/orkaudio:/etc/orkaudio sumauma/orkaudio:latest 

